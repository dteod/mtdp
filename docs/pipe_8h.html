<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>mtdp: include/mtdp/pipe.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">mtdp<span id="projectnumber">&#160;0.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_2d3ae8018822fb94f6dbe050784e5bd3.html">mtdp</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">pipe.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Header containing the pipe opaque struct and APIs to interact with it.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;stddef.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &quot;<a class="el" href="buffer_8h_source.html">mtdp/buffer.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for pipe.h:</div>
<div class="dyncontent">
<div class="center"><img src="pipe_8h__incl.png" border="0" usemap="#ainclude_2mtdp_2pipe_8h" alt=""/></div>
<map name="ainclude_2mtdp_2pipe_8h" id="ainclude_2mtdp_2pipe_8h">
<area shape="rect" title="Header containing the pipe opaque struct and APIs to interact with it." alt="" coords="111,5,245,32"/>
<area shape="rect" title=" " alt="" coords="5,80,71,107"/>
<area shape="rect" title=" " alt="" coords="95,80,165,107"/>
<area shape="rect" title=" " alt="" coords="189,80,263,107"/>
<area shape="rect" href="buffer_8h.html" title="Header containing the mtdp_buffer alias." alt="" coords="287,80,386,107"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="pipe_8h__dep__incl.png" border="0" usemap="#ainclude_2mtdp_2pipe_8hdep" alt=""/></div>
<map name="ainclude_2mtdp_2pipe_8hdep" id="ainclude_2mtdp_2pipe_8hdep">
<area shape="rect" title="Header containing the pipe opaque struct and APIs to interact with it." alt="" coords="15,5,150,32"/>
<area shape="rect" href="pipeline_8h.html" title="Header containing the main mtdp_pipeline struct and API." alt="" coords="5,80,160,107"/>
<area shape="rect" href="mtdp_8h.html" title="Umbrella header used to import libmtdp." alt="" coords="29,155,136,181"/>
</map>
</div>
</div>
<p><a href="pipe_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a0a8c8fba113256125d0d36b6f34e1ab4"><td class="memItemLeft" align="right" valign="top">typedef struct s_mtdp_pipe&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pipe_8h.html#a0a8c8fba113256125d0d36b6f34e1ab4">mtdp_pipe</a></td></tr>
<tr class="memdesc:a0a8c8fba113256125d0d36b6f34e1ab4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opaque struct used to configure a pipe.  <a href="pipe_8h.html#a0a8c8fba113256125d0d36b6f34e1ab4">More...</a><br /></td></tr>
<tr class="separator:a0a8c8fba113256125d0d36b6f34e1ab4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5513437c7b6c93df32c568180bbcc3d0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pipe_8h.html#a0a8c8fba113256125d0d36b6f34e1ab4">mtdp_pipe</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pipe_8h.html#a5513437c7b6c93df32c568180bbcc3d0">mtdp_pipe_next</a> (<a class="el" href="pipe_8h.html#a0a8c8fba113256125d0d36b6f34e1ab4">mtdp_pipe</a> *pipe)</td></tr>
<tr class="memdesc:a5513437c7b6c93df32c568180bbcc3d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the next pipe entry from a previous entry.  <a href="pipe_8h.html#a5513437c7b6c93df32c568180bbcc3d0">More...</a><br /></td></tr>
<tr class="separator:a5513437c7b6c93df32c568180bbcc3d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab436ce4afc201d5409ef4a7f21030da9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="buffer_8h.html#a5574076937e38fc8f613e15ef9b1d557">mtdp_buffer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pipe_8h.html#ab436ce4afc201d5409ef4a7f21030da9">mtdp_pipe_resize</a> (<a class="el" href="pipe_8h.html#a0a8c8fba113256125d0d36b6f34e1ab4">mtdp_pipe</a> *pipe, size_t n_buffers)</td></tr>
<tr class="memdesc:ab436ce4afc201d5409ef4a7f21030da9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resizes the pipe's internal buffers.  <a href="pipe_8h.html#ab436ce4afc201d5409ef4a7f21030da9">More...</a><br /></td></tr>
<tr class="separator:ab436ce4afc201d5409ef4a7f21030da9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93007261bf6ba4c5a03a3923e401aa40"><td class="memItemLeft" align="right" valign="top"><a class="el" href="buffer_8h.html#a5574076937e38fc8f613e15ef9b1d557">mtdp_buffer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pipe_8h.html#a93007261bf6ba4c5a03a3923e401aa40">mtdp_pipe_buffers</a> (<a class="el" href="pipe_8h.html#a0a8c8fba113256125d0d36b6f34e1ab4">mtdp_pipe</a> *pipe)</td></tr>
<tr class="memdesc:a93007261bf6ba4c5a03a3923e401aa40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the currently empty buffers' pool of a pipe.  <a href="pipe_8h.html#a93007261bf6ba4c5a03a3923e401aa40">More...</a><br /></td></tr>
<tr class="separator:a93007261bf6ba4c5a03a3923e401aa40"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Header containing the pipe opaque struct and APIs to interact with it. </p>
<p >Avoid importing this file in user code, prefer the <a class="el" href="mtdp_8h.html" title="Umbrella header used to import libmtdp.">mtdp.h</a> umbrella header. </p>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a id="a0a8c8fba113256125d0d36b6f34e1ab4" name="a0a8c8fba113256125d0d36b6f34e1ab4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a8c8fba113256125d0d36b6f34e1ab4">&#9670;&nbsp;</a></span>mtdp_pipe</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct s_mtdp_pipe <a class="el" href="pipe_8h.html#a0a8c8fba113256125d0d36b6f34e1ab4">mtdp_pipe</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opaque struct used to configure a pipe. </p>
<p >A pipe is a channel used to connect two pipeline stages. Pipe memory is contained in libmtdp, though the actual buffers to be used from within the stages shall be configured externally. This opaque struct together with its API can be used to internally allocate and then retrieve the buffers for initialization and cleanup.</p>
<p >The general use-case is as following (dummy allocation/deallocation functions used for example): </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> my_buf_init(<a class="code hl_typedef" href="buffer_8h.html#a5574076937e38fc8f613e15ef9b1d557">mtdp_buffer</a>* buf);</div>
<div class="line"><span class="keywordtype">void</span> my_buf_destroy(<a class="code hl_typedef" href="buffer_8h.html#a5574076937e38fc8f613e15ef9b1d557">mtdp_buffer</a>* buf);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">    register_signals();</div>
<div class="line">    <a class="code hl_typedef" href="pipeline_8h.html#ae2e4fb889fd1ec7a7e2dee260eccb890">mtdp_pipeline</a>* pipeline = <a class="code hl_function" href="pipeline_8h.html#ab91feeed21b7f092464010820abbaaaf">mtdp_pipeline_create</a>(STAGES);</div>
<div class="line">    <span class="comment">// ... </span></div>
<div class="line">    <a class="code hl_typedef" href="buffer_8h.html#a5574076937e38fc8f613e15ef9b1d557">mtdp_buffer</a>* buf;</div>
<div class="line">    <a class="code hl_typedef" href="pipe_8h.html#a0a8c8fba113256125d0d36b6f34e1ab4">mtdp_pipe</a>* pipes_head = <a class="code hl_function" href="pipeline_8h.html#a1664f842341cf72a0d65c9c1e81fede2">mtdp_pipeline_get_pipes</a>(pipeline);</div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = STAGES; --i; pipes_head = <a class="code hl_function" href="pipe_8h.html#a5513437c7b6c93df32c568180bbcc3d0">mtdp_pipe_next</a>(pipes_head)) {</div>
<div class="line">        buf = <a class="code hl_function" href="pipe_8h.html#ab436ce4afc201d5409ef4a7f21030da9">mtdp_pipe_resize</a>(pipes_head, nbufs = NBUFS);</div>
<div class="line">        <span class="keywordflow">if</span>(buf) {</div>
<div class="line">            <span class="keywordflow">for</span>(; --nbufs; buf++) {</div>
<div class="line">                my_buf_init(buf);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">            fprintf(<span class="stringliteral">&quot;memory allocation error\n&quot;</span>);</div>
<div class="line">            exit(-1);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">    <a class="code hl_function" href="pipeline_8h.html#a4e25676da62b288fd5bdedf1e28f6f87">mtdp_pipeline_enable</a>(pipeline);</div>
<div class="line">    <a class="code hl_function" href="pipeline_8h.html#a858a5492b550b64da0c2a23334fffc59">mtdp_pipeline_start</a>(pipeline);</div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">    <a class="code hl_function" href="pipeline_8h.html#a91f283a89c95267244ecb3e284493dbb">mtdp_pipeline_disable</a>(pipeline);</div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">    pipes_head = mtdp_pipeline_pipes(pipeline);</div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = STAGES + 1; i--; pipes_head = <a class="code hl_function" href="pipe_8h.html#a5513437c7b6c93df32c568180bbcc3d0">mtdp_pipe_next</a>(pipes_head)) {</div>
<div class="line">        <span class="keywordflow">for</span>(buf = <a class="code hl_function" href="pipe_8h.html#a93007261bf6ba4c5a03a3923e401aa40">mtdp_pipe_buffers</a>(pipes_head); --nbufs; buf++)) {</div>
<div class="line">            my_buf_destroy(buf);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_function" href="pipeline_8h.html#a448c9508806902c43ef64f47f96ba78a">mtdp_pipeline_destroy</a>(pipeline);</div>
<div class="line">}</div>
<div class="ttc" id="abuffer_8h_html_a5574076937e38fc8f613e15ef9b1d557"><div class="ttname"><a href="buffer_8h.html#a5574076937e38fc8f613e15ef9b1d557">mtdp_buffer</a></div><div class="ttdeci">void * mtdp_buffer</div><div class="ttdoc">Convenience alias used to abstract pointer syntax.</div><div class="ttdef"><b>Definition:</b> buffer.h:30</div></div>
<div class="ttc" id="apipe_8h_html_a0a8c8fba113256125d0d36b6f34e1ab4"><div class="ttname"><a href="pipe_8h.html#a0a8c8fba113256125d0d36b6f34e1ab4">mtdp_pipe</a></div><div class="ttdeci">struct s_mtdp_pipe mtdp_pipe</div><div class="ttdoc">Opaque struct used to configure a pipe.</div><div class="ttdef"><b>Definition:</b> pipe.h:90</div></div>
<div class="ttc" id="apipe_8h_html_a5513437c7b6c93df32c568180bbcc3d0"><div class="ttname"><a href="pipe_8h.html#a5513437c7b6c93df32c568180bbcc3d0">mtdp_pipe_next</a></div><div class="ttdeci">mtdp_pipe * mtdp_pipe_next(mtdp_pipe *pipe)</div><div class="ttdoc">Returns the next pipe entry from a previous entry.</div></div>
<div class="ttc" id="apipe_8h_html_a93007261bf6ba4c5a03a3923e401aa40"><div class="ttname"><a href="pipe_8h.html#a93007261bf6ba4c5a03a3923e401aa40">mtdp_pipe_buffers</a></div><div class="ttdeci">mtdp_buffer * mtdp_pipe_buffers(mtdp_pipe *pipe)</div><div class="ttdoc">Returns the currently empty buffers' pool of a pipe.</div></div>
<div class="ttc" id="apipe_8h_html_ab436ce4afc201d5409ef4a7f21030da9"><div class="ttname"><a href="pipe_8h.html#ab436ce4afc201d5409ef4a7f21030da9">mtdp_pipe_resize</a></div><div class="ttdeci">mtdp_buffer * mtdp_pipe_resize(mtdp_pipe *pipe, size_t n_buffers)</div><div class="ttdoc">Resizes the pipe's internal buffers.</div></div>
<div class="ttc" id="apipeline_8h_html_a1664f842341cf72a0d65c9c1e81fede2"><div class="ttname"><a href="pipeline_8h.html#a1664f842341cf72a0d65c9c1e81fede2">mtdp_pipeline_get_pipes</a></div><div class="ttdeci">mtdp_pipe * mtdp_pipeline_get_pipes(mtdp_pipeline *pipeline)</div><div class="ttdoc">Returns the array of pipes of a pipeline.</div></div>
<div class="ttc" id="apipeline_8h_html_a448c9508806902c43ef64f47f96ba78a"><div class="ttname"><a href="pipeline_8h.html#a448c9508806902c43ef64f47f96ba78a">mtdp_pipeline_destroy</a></div><div class="ttdeci">void mtdp_pipeline_destroy(mtdp_pipeline *pipeline)</div><div class="ttdoc">Destroys a pipeline.</div></div>
<div class="ttc" id="apipeline_8h_html_a4e25676da62b288fd5bdedf1e28f6f87"><div class="ttname"><a href="pipeline_8h.html#a4e25676da62b288fd5bdedf1e28f6f87">mtdp_pipeline_enable</a></div><div class="ttdeci">bool mtdp_pipeline_enable(mtdp_pipeline *pipeline)</div><div class="ttdoc">Enables a pipeline.</div></div>
<div class="ttc" id="apipeline_8h_html_a858a5492b550b64da0c2a23334fffc59"><div class="ttname"><a href="pipeline_8h.html#a858a5492b550b64da0c2a23334fffc59">mtdp_pipeline_start</a></div><div class="ttdeci">bool mtdp_pipeline_start(mtdp_pipeline *pipeline)</div><div class="ttdoc">Starts a pipeline.</div></div>
<div class="ttc" id="apipeline_8h_html_a91f283a89c95267244ecb3e284493dbb"><div class="ttname"><a href="pipeline_8h.html#a91f283a89c95267244ecb3e284493dbb">mtdp_pipeline_disable</a></div><div class="ttdeci">bool mtdp_pipeline_disable(mtdp_pipeline *pipeline)</div><div class="ttdoc">Disables a pipeline.</div></div>
<div class="ttc" id="apipeline_8h_html_ab91feeed21b7f092464010820abbaaaf"><div class="ttname"><a href="pipeline_8h.html#ab91feeed21b7f092464010820abbaaaf">mtdp_pipeline_create</a></div><div class="ttdeci">mtdp_pipeline * mtdp_pipeline_create(const mtdp_pipeline_parameters *params)</div><div class="ttdoc">Creates a multi-threaded data pipeline and returns a pointer to it.</div></div>
<div class="ttc" id="apipeline_8h_html_ae2e4fb889fd1ec7a7e2dee260eccb890"><div class="ttname"><a href="pipeline_8h.html#ae2e4fb889fd1ec7a7e2dee260eccb890">mtdp_pipeline</a></div><div class="ttdeci">struct s_mtdp_pipeline mtdp_pipeline</div><div class="ttdoc">Opaque struct used to manage a multi-threaded data pipeline.</div><div class="ttdef"><b>Definition:</b> pipeline.h:80</div></div>
</div><!-- fragment --> 
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a93007261bf6ba4c5a03a3923e401aa40" name="a93007261bf6ba4c5a03a3923e401aa40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93007261bf6ba4c5a03a3923e401aa40">&#9670;&nbsp;</a></span>mtdp_pipe_buffers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="buffer_8h.html#a5574076937e38fc8f613e15ef9b1d557">mtdp_buffer</a> * mtdp_pipe_buffers </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pipe_8h.html#a0a8c8fba113256125d0d36b6f34e1ab4">mtdp_pipe</a> *&#160;</td>
          <td class="paramname"><em>pipe</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the currently empty buffers' pool of a pipe. </p>
<p >Returns a pointer to the first element of a random-access array. Use this function to initialize the buffers after a resize, but before enabling the pipeline.</p>
<dl class="section warning"><dt>Warning</dt><dd>Even though this function is thread-safe, accessing the buffers while the pipeline is operating will more likely than not corrupt the data, or cause a segfault in a <code>malloc</code>d runtime. So avoid that.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pipe</td><td>the pipe to retrieve the buffers from </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mtdp_buffer* a linear array of buffers whose size should have been previously set by the user, NULL on error or if size is 0 </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">MTDP_OK</td><td></td></tr>
    <tr><td class="paramname">MTDP_BAD_PTR</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5513437c7b6c93df32c568180bbcc3d0" name="a5513437c7b6c93df32c568180bbcc3d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5513437c7b6c93df32c568180bbcc3d0">&#9670;&nbsp;</a></span>mtdp_pipe_next()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pipe_8h.html#a0a8c8fba113256125d0d36b6f34e1ab4">mtdp_pipe</a> * mtdp_pipe_next </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pipe_8h.html#a0a8c8fba113256125d0d36b6f34e1ab4">mtdp_pipe</a> *&#160;</td>
          <td class="paramname"><em>pipe</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the next pipe entry from a previous entry. </p>
<p >mtdp_pipe is an opaque type, so its size is not to be exposed in client code. Use this function to retrieve the next entry.</p>
<dl class="section warning"><dt>Warning</dt><dd>No bounds checking is performed. The number of times this function may be called equals the <code>internal_stages</code> parameter used to instantiate the pipeline.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pipe</td><td>the pipe to retrieve the next entry from </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mtdp_pipe* the pipe after the one given as a parameter </dd></dl>

</div>
</div>
<a id="ab436ce4afc201d5409ef4a7f21030da9" name="ab436ce4afc201d5409ef4a7f21030da9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab436ce4afc201d5409ef4a7f21030da9">&#9670;&nbsp;</a></span>mtdp_pipe_resize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="buffer_8h.html#a5574076937e38fc8f613e15ef9b1d557">mtdp_buffer</a> * mtdp_pipe_resize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pipe_8h.html#a0a8c8fba113256125d0d36b6f34e1ab4">mtdp_pipe</a> *&#160;</td>
          <td class="paramname"><em>pipe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n_buffers</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resizes the pipe's internal buffers. </p>
<p >Depending on the requested number of buffers, this function will:</p><ul>
<li>expand the pool of empty buffers, if more space is required;</li>
<li>do nothing if the actual total number of buffers equals <code>n_buffers</code>;</li>
<li>remove buffers from its internal structures with these priorities:<ol type="1">
<li>shrink the pool of empty buffers;</li>
<li>remove the fifo entries from the oldest one, if the buffer reduction exceeds the number of empty buffers;</li>
</ol>
</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This function is not thread-safe, and it should not be called while the pipeline is active. It is only useful to preallocate memory or to expand it at runtime (after pausing the pipeline).</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>If a smaller number of buffers is requested, these buffers owned memory, and they were not properly destructed, that memory will leak. Always shrink after proper buffer destruction.</dd>
<dd>
A data reduction while the pipeline is operating may lead to a data loss if not in a <code>malloc</code>d environment.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pipe</td><td>the pipe to resize </td></tr>
    <tr><td class="paramname">n_buffers</td><td>the number of buffers required for the resize</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mtdp_buffer* a pointer to an array of mtdp_buffer, NULL on error </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">MTDP_OK</td><td></td></tr>
    <tr><td class="paramname">MTDP_BAD_PTR</td><td></td></tr>
    <tr><td class="paramname">MTDP_NO_MEM</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
